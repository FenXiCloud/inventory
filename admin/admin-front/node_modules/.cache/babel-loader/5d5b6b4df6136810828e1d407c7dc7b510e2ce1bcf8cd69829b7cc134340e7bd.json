{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"tabs-container\",\n  ref: \"scrollOuter\"\n};\nconst _hoisted_2 = {\n  class: \"tabs-body\"\n};\nconst _hoisted_3 = [\"index\", \"onClick\"];\nconst _hoisted_4 = {\n  class: \"tabs-item-title\"\n};\nconst _hoisted_5 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_DropdownMenu = _resolveComponent(\"DropdownMenu\");\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"sys-tabs-vue\", {\n      'sys-tabs-oversize': $data.tagList.length > 15\n    }])\n  }, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_DropdownMenu, {\n    datas: $data.menus,\n    onClickItem: $options.trigger,\n    onShow: $options.show,\n    trigger: \"contextMenu\",\n    toggleIcon: false\n  }, {\n    default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.tagList, (item, index) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: `sys-tab-${index}`,\n        index: index,\n        onClick: $event => $options.handleClick(item),\n        class: _normalizeClass([\"tabs-item\", {\n          'tabs-item-chosen': $options.isCurrentTab(item)\n        }])\n      }, [_cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n        class: \"tabs-item-background\"\n      }, null, -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_4, [_cache[0] || (_cache[0] = _createElementVNode(\"span\", {\n        class: \"tabs-item-icon\"\n      }, null, -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString(item.meta.title), 1 /* TEXT */)]), $props.homePage != item.name ? (_openBlock(), _createElementBlock(\"span\", {\n        key: 0,\n        class: \"tabs-item-close h-icon-close\",\n        onClick: _withModifiers($event => $options.handleClose(item), [\"stop\"])\n      }, null, 8 /* PROPS */, _hoisted_5)) : _createCommentVNode(\"v-if\", true)], 10 /* CLASS, PROPS */, _hoisted_3);\n    }), 128 /* KEYED_FRAGMENT */))]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"datas\", \"onClickItem\", \"onShow\"])])], 512 /* NEED_PATCH */)], 2 /* CLASS */);\n}","map":{"version":3,"names":["class","ref","_createElementBlock","_normalizeClass","$data","tagList","length","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","_component_DropdownMenu","datas","menus","onClickItem","$options","trigger","onShow","show","toggleIcon","default","_withCtx","_Fragment","_renderList","item","index","key","onClick","$event","handleClick","isCurrentTab","_hoisted_4","_toDisplayString","meta","title","$props","homePage","name","_withModifiers","handleClose","_hoisted_5","_createCommentVNode","_hoisted_3","_"],"sources":["D:\\DevWorks\\jxc\\admin\\admin-front\\src\\components\\common\\sys-tabs\\sys-tabs.vue"],"sourcesContent":["<template>\r\n  <div class=\"sys-tabs-vue\" :class=\"{ 'sys-tabs-oversize': tagList.length > 15 }\">\r\n    <div class=\"tabs-container\" ref=\"scrollOuter\">\r\n      <div class=\"tabs-body\">\r\n        <DropdownMenu :datas=\"menus\" @clickItem=\"trigger\" @show=\"show\" trigger=\"contextMenu\" :toggleIcon=\"false\">\r\n          <div\r\n              v-for=\"(item, index) of tagList\"\r\n              :key=\"`sys-tab-${index}`\"\r\n              :index=\"index\"\r\n              @click=\"handleClick(item)\"\r\n              class=\"tabs-item\"\r\n              :class=\"{ 'tabs-item-chosen': isCurrentTab(item) }\"\r\n          >\r\n            <div class=\"tabs-item-background\"></div>\r\n            <div class=\"tabs-item-title\">\r\n              <span  class=\"tabs-item-icon\"></span>\r\n              <span>{{ item.meta.title }}</span>\r\n            </div>\r\n            <span class=\"tabs-item-close h-icon-close\" @click.stop=\"handleClose(item)\" v-if=\"homePage != item.name\"></span>\r\n          </div>\r\n        </DropdownMenu>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {showTitle, routeEqual, isExsit} from './utils';\r\nimport {confirm} from \"heyui.ext\";\r\n\r\nexport default {\r\n  name: 'TagsNav',\r\n  props: {\r\n    value: Object,\r\n    homePage: {\r\n      type: String,\r\n      default: 'DashboardMain'\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      nowIndex: null,\r\n      tagList: [],\r\n      menus: {}\r\n    };\r\n  },\r\n  computed: {\r\n    currentRouteObj() {\r\n      const {name, params, query} = this.$route;\r\n      return {name, params, query};\r\n    }\r\n  },\r\n  methods: {\r\n    show(event) {\r\n      let parent = event.target.parentNode;\r\n      this.nowIndex = parent.getAttribute('index') || parent.parentNode.getAttribute('index');\r\n      if (this.nowIndex == null) {\r\n        this.menus = {\r\n          closeAll: '关闭所有标签页'\r\n        };\r\n      } else {\r\n        this.menus = {\r\n          closeSelf: '关闭标签页',\r\n          closeOther: '关闭其他标签页',\r\n          closeAll: '关闭所有标签页'\r\n        };\r\n      }\r\n    },\r\n    trigger(key, data, event) {\r\n      if (key == 'closeAll') {\r\n        this.clearTab();\r\n      } else if (this.nowIndex) {\r\n        let item = this.tagList[this.nowIndex];\r\n        if (key == 'closeOther') {\r\n          this.closeOtherTab(item, this.nowIndex);\r\n        } else if (key == 'closeSelf') {\r\n          this.close(item);\r\n        }\r\n      }\r\n    },\r\n    init() {\r\n      let cache = localStorage.getItem(\"ADMIN_SYS_TABS\");\r\n      this.tagList = cache ? JSON.parse(cache) : [];\r\n      this.gotoTab(this.$route);\r\n    },\r\n    beforeClose() {\r\n      return confirm('确定要关闭这一页吗');\r\n    },\r\n    handleClose(item) {\r\n      if (item.meta && item.meta.beforeCloseName) {\r\n        return new Promise(this.beforeClose[item.meta.beforeCloseName]).then(close => {\r\n          if (close) {\r\n            this.close(item);\r\n          }\r\n        });\r\n      } else {\r\n        this.close(item);\r\n      }\r\n    },\r\n    close(item) {\r\n      let index = this.tagList.indexOf(item);\r\n      this.tagList.splice(index, 1);\r\n      let newroute = null;\r\n      if (this.isCurrentTab(item)) {\r\n        if (this.tagList.length > index) {\r\n          newroute = this.tagList[index];\r\n        } else if (this.tagList.length > 0) {\r\n          newroute = this.tagList[index - 1];\r\n        } else {\r\n          this.$router.replace({name: this.homePage});\r\n        }\r\n        if (newroute) this.$router.replace(newroute);\r\n      }\r\n      this.saveLocal();\r\n    },\r\n    handleClick(item) {\r\n      this.$router.push(item);\r\n    },\r\n    showTitleInside(item) {\r\n      return showTitle(item, this);\r\n    },\r\n    isCurrentTab(item) {\r\n      return routeEqual(this.currentRouteObj, item);\r\n    },\r\n    gotoTab(item) {\r\n      if (!item.name) return;\r\n      const {name, query, params, meta} = item;\r\n      let routeObj = {name, query, params, meta: meta || {}};\r\n      if (!isExsit(routeObj, this.tagList) && routeObj.name !== 'Login') {\r\n        this.tagList.push(routeObj);\r\n        this.saveLocal();\r\n      }\r\n    },\r\n    closeOtherTab(item, index) {\r\n      if (!this.isCurrentTab(item)) {\r\n        this.$router.push(item);\r\n      }\r\n      this.tagList.splice(0, index);\r\n      this.tagList.splice(1);\r\n      this.saveLocal();\r\n    },\r\n    clearTab() {\r\n      this.tagList = [];\r\n      this.saveLocal();\r\n      if (!this.isCurrentTab({name: this.homePage})) {\r\n        this.$router.push({name: this.homePage});\r\n      }\r\n    },\r\n    saveLocal() {\r\n      localStorage.setItem(\"ADMIN_SYS_TABS\", JSON.stringify(this.tagList))\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  watch: {\r\n    $route(to) {\r\n      this.gotoTab(to);\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\">\r\n\r\n.sys-tabs-vue {\r\n  position: relative;\r\n  background: #fff;\r\n  user-select: none;\r\n  z-index: 1;\r\n  height: 40px;\r\n\r\n  .close-con {\r\n    position: absolute;\r\n    right: 0;\r\n    top: 0;\r\n    height: 100%;\r\n    width: 32px;\r\n    background: #fff;\r\n    text-align: center;\r\n    z-index: 10;\r\n  }\r\n\r\n  .tabs-container {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n\r\n\r\n    .tabs-body {\r\n      height: 100%;\r\n      //box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.09);\r\n      padding: 0px 0 0;\r\n\r\n\r\n      .h-dropdownmenu {\r\n        display: block;\r\n      }\r\n\r\n      .h-dropdowncustom-show-content {\r\n        overflow: hidden;\r\n        padding: 0 8px;\r\n        white-space: nowrap;\r\n        display: flex;\r\n      }\r\n    }\r\n\r\n    .tabs-item {\r\n      transition: 0.2s;\r\n      line-height: @sys-tabs-height - 9px;\r\n      height: @sys-tabs-height - 10px;\r\n      padding: 0 15px 0 15px;\r\n      position: relative;\r\n      max-width: 120px;\r\n      flex: 1;\r\n      margin-left: -4px;\r\n      margin-right: -4px;\r\n      cursor: pointer;\r\n      overflow: hidden;\r\n\r\n\r\n      &:after {\r\n        content: '';\r\n        display: inline-block;\r\n        position: absolute;\r\n        right: 0;\r\n        height: 20px;\r\n        bottom: 6px;\r\n        //border-right: 1px solid #b5b5b5;\r\n      }\r\n\r\n      &-title {\r\n        position: relative;\r\n        z-index: 2;\r\n        font-size: 14px;\r\n        overflow: hidden;\r\n        margin-right: 15px;\r\n\r\n\r\n        .tabs-item-icon {\r\n          margin-right: 5px;\r\n          position: relative;\r\n          top: -1px;\r\n        }\r\n      }\r\n\r\n      &-background {\r\n        color: #ebecef;\r\n        position: absolute;\r\n        right: 4px;\r\n        top: 0;\r\n        left: 3px;\r\n        bottom: 0;\r\n        border-top: #e6e7ea 1px solid;\r\n        /* 确保其他边框不可见 */\r\n        border-right: #e6e7ea 1px solid;\r\n        border-bottom: #e6e7ea 1px solid;\r\n        border-left: #e6e7ea 1px solid;\r\n        //border-radius: 3px 3px 0 0;\r\n      }\r\n\r\n      &.tabs-item-chosen,\r\n      &:hover {\r\n        z-index: 1;\r\n\r\n        &:after,\r\n        &:before {\r\n          content: '';\r\n          bottom: 0;\r\n          position: absolute;\r\n          top: auto;\r\n          border-right: none;\r\n        }\r\n\r\n        &:after {\r\n          width: 0;\r\n          height: 0;\r\n          //border-right: 1px solid transparent;\r\n          right: 0px;\r\n          z-index: 3;\r\n        }\r\n\r\n        &:before {\r\n          width: 0;\r\n          height: 0;\r\n          //border-left: 1px solid transparent;\r\n          left: 0px;\r\n          z-index: 3;\r\n        }\r\n      }\r\n\r\n      @sysTabHoverColor: #ebecef;\r\n\r\n      &:hover {\r\n        .tabs-item-background {\r\n          background: @sysTabHoverColor;\r\n        }\r\n\r\n        &:after {\r\n          border-bottom: 1px solid @sysTabHoverColor;\r\n        }\r\n\r\n        &:before {\r\n          border-bottom: 1px solid @sysTabHoverColor;\r\n        }\r\n      }\r\n\r\n      &.tabs-item-chosen {\r\n        z-index: 2;\r\n\r\n        .tabs-item-background {\r\n          background: #f5f7fa;\r\n          border-top:#3d74ff 2px solid;\r\n          border-bottom: none;\r\n        }\r\n\r\n        &:after {\r\n          border-bottom: 10px solid #fff;\r\n        }\r\n\r\n        &:before {\r\n          border-bottom: 10px solid #fff;\r\n        }\r\n      }\r\n\r\n      &-close {\r\n        transition: 0.2s;\r\n        font-size: 12px;\r\n        position: absolute;\r\n        right: 10px;\r\n        color: #999;\r\n        cursor: pointer;\r\n        border-radius: 50%;\r\n        padding: 4px;\r\n        top: 50%;\r\n        margin-top: -9px;\r\n        transform: scale(0.8);\r\n\r\n        &:hover {\r\n          color: @gray4-color;\r\n          background: @dark4-color;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  &.sys-tabs-oversize {\r\n    .tabs-item:not(.tabs-item-chosen) {\r\n      padding-right: 10px;\r\n\r\n      .tabs-item-close {\r\n        display: none;\r\n      }\r\n\r\n      .tabs-item-title {\r\n        margin-right: 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";;EAESA,KAAK,EAAC,gBAAgB;EAACC,GAAG,EAAC;;;EACzBD,KAAK,EAAC;AAAW;mBAH5B;;EAciBA,KAAK,EAAC;AAAiB;mBAdxC;;;uBACEE,mBAAA,CAsBM;IAtBDF,KAAK,EADZG,eAAA,EACa,cAAc;MAAA,qBAAgCC,KAAA,CAAAC,OAAO,CAACC,MAAM;IAAA;MACrEC,mBAAA,CAoBM,OApBNC,UAoBM,GAnBJD,mBAAA,CAkBM,OAlBNE,UAkBM,GAjBJC,YAAA,CAgBeC,uBAAA;IAhBAC,KAAK,EAAER,KAAA,CAAAS,KAAK;IAAGC,WAAS,EAAEC,QAAA,CAAAC,OAAO;IAAGC,MAAI,EAAEF,QAAA,CAAAG,IAAI;IAAEF,OAAO,EAAC,aAAa;IAAEG,UAAU,EAAE;;IAJ1GC,OAAA,EAAAC,QAAA,CAMc,MAAgC,E,kBADpCnB,mBAAA,CAcMoB,SAAA,QAnBhBC,WAAA,CAMsCnB,KAAA,CAAAC,OAAO,EAN7C,CAMsBmB,IAAI,EAAEC,KAAK;2BADvBvB,mBAAA,CAcM;QAZDwB,GAAG,aAAaD,KAAK;QACrBA,KAAK,EAAEA,KAAK;QACZE,OAAK,EAAAC,MAAA,IAAEb,QAAA,CAAAc,WAAW,CAACL,IAAI;QACxBxB,KAAK,EAVnBG,eAAA,EAUoB,WAAW;UAAA,oBACaY,QAAA,CAAAe,YAAY,CAACN,IAAI;QAAA;oCAEjDjB,mBAAA,CAAwC;QAAnCP,KAAK,EAAC;MAAsB,6BACjCO,mBAAA,CAGM,OAHNwB,UAGM,G,0BAFJxB,mBAAA,CAAqC;QAA9BP,KAAK,EAAC;MAAgB,6BAC7BO,mBAAA,CAAkC,cAAAyB,gBAAA,CAAzBR,IAAI,CAACS,IAAI,CAACC,KAAK,iB,GAEuDC,MAAA,CAAAC,QAAQ,IAAIZ,IAAI,CAACa,IAAI,I,cAAtGnC,mBAAA,CAA+G;QAlB3HwB,GAAA;QAkBkB1B,KAAK,EAAC,8BAA8B;QAAE2B,OAAK,EAlB7DW,cAAA,CAAAV,MAAA,IAkBoEb,QAAA,CAAAwB,WAAW,CAACf,IAAI;8BAlBpFgB,UAAA,KAAAC,mBAAA,e,yBAAAC,UAAA;;IAAAC,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}