import{openBlock as h,createElementBlock as r,createElementVNode as d,normalizeClass as l,normalizeStyle as a,renderSlot as x}from"vue";import{_ as p}from"./_plugin-vue_export-helper.js";const n="h-affix",c={name:"HAffix",emits:["change"],props:{offsetTop:Number,offsetBottom:Number,container:Function,fixedOffsetTop:Number,fixedOffsetBottom:Number,disabled:{type:Boolean,default:!1}},data(){return{isFixed:!1,fixPosition:"top",containerDom:null,isAbsolute:!!this.container&&!this.disabled,y:0}},computed:{cFixedOffsetTop(){return this.fixedOffsetTop||this.offsetTop},cFixedOffsetBottom(){return this.fixedOffsetBottom||this.offsetBottom},affixCls(){return{[n]:this.isFixed,[`${n}-absolute`]:this.isAbsolute}},affixStyle(){let t={};return this.isFixed&&(this.fixPosition=="top"?t.top=`${this.cFixedOffsetTop}px`:t.bottom=`${this.cFixedOffsetBottom}px`),this.isAbsolute&&(this.fixPosition=="top"?t.top=`${this.offsetTop}px`:t.bottom=`${this.offsetBottom}px`),t}},watch:{offsetTop(){this.refresh()},offsetBottom(){this.refresh()},fixedOffsetTop(){this.refresh()},fixedOffsetBottom(){this.refresh()},disabled(){this.disabled?(this.isFixed=!1,this.isAbsolute=!1):this.refresh()}},mounted(){this.$nextTick(()=>{this.container&&(this.containerDom=this.container.call()),window.addEventListener("scroll",this.trigger,!0),window.addEventListener("resize",this.trigger),this.refresh()})},beforeUnmount(){window.removeEventListener("scroll",this.trigger,!0),window.removeEventListener("resize",this.trigger)},methods:{refresh(){let t=document.createEvent("HTMLEvents");t.initEvent("scroll",!0,!0),document.body.dispatchEvent(t)},trigger(t){if(this.disabled)return;let e=this.$el.firstChild;if(t.target==e)return!1;let o=this.isFixed;if(this.containerDom){let i=e.getBoundingClientRect(),s=this.containerDom.getBoundingClientRect();this.y=s.top,s.top<=this.cFixedOffsetTop-this.offsetTop&&s.bottom>=i.height+this.cFixedOffsetTop+this.cFixedOffsetBottom?(this.isFixed=!0,this.isAbsolute=!1,this.fixPosition="top"):s.top>this.cFixedOffsetTop-this.offsetTop||s.height<i.height?(this.isFixed=!1,this.isAbsolute=!0,this.fixPosition="top"):s.bottom<i.height+this.cFixedOffsetTop+this.cFixedOffsetBottom&&(this.isFixed=!1,this.isAbsolute=!0,this.fixPosition="bottom"),o!=this.isFixed&&this.$emit("change",this.isFixed)}else{if(this.isFixed){if(e.parentNode){let i=e.parentNode.getBoundingClientRect();this.offsetTop!==void 0&&this.fixPosition=="top"&&i.top>this.offsetTop&&(this.isFixed=!1),this.isFixed&&this.offsetBottom!=null&&this.fixPosition=="bottom"&&window.innerHeight>i.top+e.clientHeight+this.offsetBottom&&(this.isFixed=!1)}}else{let i=e.getBoundingClientRect();this.offsetTop!==void 0&&i.top<this.offsetTop&&(this.isFixed=!0,this.fixPosition="top"),!this.isFixed&&this.offsetBottom!=null&&window.innerHeight<i.top+e.clientHeight+this.offsetBottom&&(this.isFixed=!0,this.fixPosition="bottom")}o!=this.isFixed&&this.$emit("change",this.isFixed)}}}};function m(t,e,o,i,s,f){return h(),r("div",null,[d("div",{class:l(f.affixCls),style:a(f.affixStyle)},[x(t.$slots,"default")],6)])}const F=p(c,[["render",m]]);export{F as A};
