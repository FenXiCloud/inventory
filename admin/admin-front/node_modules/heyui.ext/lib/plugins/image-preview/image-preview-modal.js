import{u as h}from"../../utils.js";import{L as v}from"../../loading.js";import{M as x}from"../../modal.js";import{resolveComponent as g,openBlock as l,createBlock as _,withCtx as c,createElementVNode as r,normalizeStyle as S,createElementBlock as d,toDisplayString as p,createCommentVNode as m,createVNode as u,Transition as y,withDirectives as I,vShow as M,renderSlot as k}from"vue";import{_ as D}from"../../_plugin-vue_export-helper.js";import"../../utils/config.js";import"../draggable.js";const F={name:"HImagePreviewModal",components:{Loading:v,Modal:x},props:{isShow:{type:Boolean,default:!1}},data(){return{openModal:!1,datas:[],index:0,height:200,width:200,showIndex:-1,changeing:!1,previewFile:{}}},computed:{previewStyle(){return{height:`${this.height}px`,width:`${this.width}px`}},computedDatas(){return h.isString(this.datas)?[this.datas]:h.isArray(this.datas)?this.datas:[]},isShowIndex(){return!h.isString(this.datas)}},watch:{openModal(){this.openModal&&this.change(this.index)},isShow(){}},mounted(){},methods:{close(){this.previewFile={},this.height=200,this.width=200},initStyle(t){let e=this.$refs.img.width,n=this.$refs.img.height;if(e>800||n>12e3){let a=Math.max(e/800,n/12e3);e=e/a,n=n/a}this.width=e,this.height=n,setTimeout(()=>{this.changeing=!1},300)},change(t){if(t<0||t>this.computedDatas.length-1)return!1;this.changeing=!0,setTimeout(()=>{this.showIndex=t,this.updatePreview()},300)},updatePreview(){if(this.computedDatas.length==0)return;let t=this.computedDatas[this.showIndex],e=h.isString(t)?{url:t}:t;e.url===this.previewFile.url&&this.$nextTick(()=>{this.$refs.img&&this.$refs.img.complete&&setTimeout(()=>{this.changeing=!1},300)}),this.previewFile=e}}},C={key:0,class:"h-image-preview-index"},V=r("i",{class:"h-icon-left"},null,-1),L=[V],T=["src","alt"],B=r("i",{class:"h-icon-right"},null,-1),P=[B];function N(t,e,n,a,i,s){const w=g("Loading"),f=g("Modal");return l(),_(f,{modelValue:i.openModal,"onUpdate:modelValue":e[3]||(e[3]=o=>i.openModal=o),onClose:s.close},{default:c(()=>[r("div",{class:"h-image-preview",style:S(s.previewStyle)},[s.isShowIndex?(l(),d("span",C,p(i.showIndex+1)+" / "+p(s.computedDatas.length),1)):m("",!0),i.showIndex!=0?(l(),d("span",{key:1,class:"h-image-preview-icon h-image-preview-left-icon",onClick:e[0]||(e[0]=o=>s.change(i.showIndex-1))},L)):m("",!0),u(y,{name:"fade"},{default:c(()=>[I(r("img",{ref:"img",src:i.previewFile.url,class:"h-image-preview-image",alt:i.previewFile.name,onLoad:e[1]||(e[1]=(...o)=>s.initStyle&&s.initStyle(...o))},null,40,T),[[M,!i.changeing]])]),_:1}),k(t.$slots,"item",{data:i.previewFile,index:i.index}),i.showIndex!=s.computedDatas.length-1?(l(),d("span",{key:2,class:"h-image-preview-icon h-image-preview-right-icon",onClick:e[2]||(e[2]=o=>s.change(i.showIndex+1))},P)):m("",!0),u(w,{loading:i.changeing},null,8,["loading"])],4)]),_:3},8,["modelValue","onClose"])}const q=D(F,[["render",N]]);export{q as default};
