{"ast":null,"code":"import \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport axios from 'axios';\nimport { loadingBar, message } from 'heyui.ext';\naxios.defaults.headers.common = {\n  'X-Requested-With': 'XMLHttpRequest'\n};\nconst DefaultParam = {\n  repeatable: false\n};\nlet request = {\n  PREFIX: '/api',\n  Author: 'gson',\n  requestingApi: new Set(),\n  extractUrl: function (url) {\n    return url ? url.split('?')[0] : '';\n  },\n  isRequesting: function (url) {\n    let api = this.extractUrl(url);\n    return this.requestingApi.has(api);\n  },\n  addRequest: function (url) {\n    let api = this.extractUrl(url);\n    this.requestingApi.add(api);\n  },\n  deleteRequest: function (url) {\n    let api = this.extractUrl(url);\n    this.requestingApi.delete(api);\n  },\n  get: function (url, param, extendParam) {\n    let params = {\n      url,\n      method: 'GET'\n    };\n    if (param) {\n      params.params = param;\n    }\n    return this.ajax(params, extendParam);\n  },\n  post: function (url, data, extendParam) {\n    let params = {\n      url,\n      data,\n      method: 'POST'\n    };\n    return this.ajax(params, extendParam);\n  },\n  put: function (url, data, extendParam) {\n    let params = {\n      url,\n      data,\n      method: 'PUT'\n    };\n    return this.ajax(params, extendParam);\n  },\n  postJson: function (url, paramJson, extendParam) {\n    return this.ajax({\n      url,\n      method: 'POST',\n      data: paramJson\n    }, extendParam);\n  },\n  patchJson: function (url, paramJson, dataType, extendParam) {\n    return this.ajax({\n      url,\n      method: 'PATCH',\n      data: paramJson\n    }, extendParam);\n  },\n  delete: function (url, extendParam) {\n    return this.ajax({\n      url: url,\n      method: 'DELETE'\n    }, extendParam);\n  },\n  ajax: function (param, extendParam) {\n    let params = Object.assign({}, DefaultParam, param, extendParam || {});\n    params.crossDomain = params.url.indexOf('http') === 0;\n    let url = params.url;\n    if (!params.crossDomain) {\n      url = params.url = this.PREFIX + params.url;\n    }\n    if (params.method !== 'GET') {\n      if (this.isRequesting(url)) {\n        return new Promise((resolve, reject) => {\n          reject({\n            success: false,\n            msg: '重复请求'\n          });\n        });\n      }\n      if (params.repeatable === false) {\n        this.addRequest(url);\n      }\n    }\n    let header = {\n      author: this.Author\n    };\n    let defaultParam = {\n      headers: header,\n      responseType: 'json',\n      validateStatus: function (status) {\n        return true;\n      }\n    };\n    if (params.crossDomain) {\n      defaultParam.headers = {};\n    }\n    let that = this;\n    params = Object.assign({}, defaultParam, params);\n    return new Promise((resolve, reject) => {\n      loadingBar.start();\n      return axios.request(params).then(response => {\n        that.deleteRequest(params.url);\n        let data = response.data;\n        let status = response.status;\n        if (status !== 200) {\n          if (status === 500) {\n            message.error('后台异常');\n            reject();\n            return;\n          } else if (status === 404) {\n            message.error('请求不存在');\n            reject();\n            return;\n          } else if (status === 403) {\n            window.location.replace(\"/\");\n            return;\n          }\n        }\n        if (response.config.responseType === 'blob') {\n          resolve(data);\n        } else if (response.config.responseType === 'json') {\n          if (data.success) {\n            resolve(data);\n          } else {\n            data.msg && message.error(data.msg);\n            if (data.code === 403) {\n              window.location.replace(\"/\");\n            }\n            reject(data);\n          }\n        } else {\n          resolve(response);\n        }\n      }).catch(() => {\n        that.deleteRequest(params.url);\n        reject({\n          success: false\n        });\n      }).finally(() => {\n        loadingBar.success();\n      });\n    });\n  }\n};\nexport default request;","map":{"version":3,"names":["axios","loadingBar","message","defaults","headers","common","DefaultParam","repeatable","request","PREFIX","Author","requestingApi","Set","extractUrl","url","split","isRequesting","api","has","addRequest","add","deleteRequest","delete","get","param","extendParam","params","method","ajax","post","data","put","postJson","paramJson","patchJson","dataType","Object","assign","crossDomain","indexOf","Promise","resolve","reject","success","msg","header","author","defaultParam","responseType","validateStatus","status","that","start","then","response","error","window","location","replace","config","code","catch","finally"],"sources":["D:/DevWorks/jxc/merchant/merchant-front/src/js/common/Request.js"],"sourcesContent":["import axios from 'axios';\r\nimport {loadingBar, message} from 'heyui.ext';\r\n\r\naxios.defaults.headers.common = {\r\n\t'X-Requested-With': 'XMLHttpRequest',\r\n};\r\n\r\nconst DefaultParam = {repeatable: false};\r\n\r\nlet request = {\r\n\tPREFIX: '/api',\r\n\tAuthor: 'gson',\r\n\trequestingApi: new Set(),\r\n\textractUrl: function (url) {\r\n\t\treturn url ? url.split('?')[0] : '';\r\n\t},\r\n\tisRequesting: function (url) {\r\n\t\tlet api = this.extractUrl(url);\r\n\t\treturn this.requestingApi.has(api);\r\n\t},\r\n\taddRequest: function (url) {\r\n\t\tlet api = this.extractUrl(url);\r\n\t\tthis.requestingApi.add(api);\r\n\t},\r\n\tdeleteRequest: function (url) {\r\n\t\tlet api = this.extractUrl(url);\r\n\t\tthis.requestingApi.delete(api);\r\n\t},\r\n\tget: function (url, param, extendParam) {\r\n\t\tlet params = {\r\n\t\t\turl,\r\n\t\t\tmethod: 'GET'\r\n\t\t};\r\n\t\tif (param) {\r\n\t\t\tparams.params = param;\r\n\t\t}\r\n\t\treturn this.ajax(params, extendParam);\r\n\t},\r\n\tpost: function (url, data, extendParam) {\r\n\t\tlet params = {\r\n\t\t\turl,\r\n\t\t\tdata,\r\n\t\t\tmethod: 'POST'\r\n\t\t};\r\n\t\treturn this.ajax(params, extendParam);\r\n\t},\r\n\tput: function (url, data, extendParam) {\r\n\t\tlet params = {\r\n\t\t\turl,\r\n\t\t\tdata,\r\n\t\t\tmethod: 'PUT'\r\n\t\t};\r\n\t\treturn this.ajax(params, extendParam);\r\n\t},\r\n\tpostJson: function (url, paramJson, extendParam) {\r\n\t\treturn this.ajax({\r\n\t\t\turl,\r\n\t\t\tmethod: 'POST',\r\n\t\t\tdata: paramJson\r\n\t\t}, extendParam);\r\n\t},\r\n\tpatchJson: function (url, paramJson, dataType, extendParam) {\r\n\t\treturn this.ajax({\r\n\t\t\turl,\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\tdata: paramJson\r\n\t\t}, extendParam);\r\n\t},\r\n\tdelete: function (url, extendParam) {\r\n\t\treturn this.ajax({\r\n\t\t\turl: url,\r\n\t\t\tmethod: 'DELETE'\r\n\t\t}, extendParam);\r\n\t},\r\n\tajax: function (param, extendParam) {\r\n\t\tlet params = Object.assign({}, DefaultParam, param, extendParam || {});\r\n\t\tparams.crossDomain = params.url.indexOf('http') === 0;\r\n\t\tlet url = params.url;\r\n\t\tif (!params.crossDomain) {\r\n\t\t\turl = params.url = this.PREFIX + params.url;\r\n\t\t}\r\n\t\tif (params.method !== 'GET') {\r\n\t\t\tif (this.isRequesting(url)) {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\treject({success: false, msg: '重复请求'});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (params.repeatable === false) {\r\n\t\t\t\tthis.addRequest(url);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet header = {\r\n\t\t\tauthor: this.Author\r\n\t\t};\r\n\r\n\t\tlet defaultParam = {\r\n\t\t\theaders: header,\r\n\t\t\tresponseType: 'json',\r\n\t\t\tvalidateStatus: function (status) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t};\r\n\t\tif (params.crossDomain) {\r\n\t\t\tdefaultParam.headers = {};\r\n\t\t}\r\n\t\tlet that = this;\r\n\t\tparams = Object.assign({}, defaultParam, params);\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tloadingBar.start();\r\n\t\t\treturn axios.request(params).then((response) => {\r\n\t\t\t\tthat.deleteRequest(params.url);\r\n\r\n\t\t\t\tlet data = response.data;\r\n\t\t\t\tlet status = response.status;\r\n\t\t\t\tif (status !== 200) {\r\n\t\t\t\t\tif (status === 500) {\r\n\t\t\t\t\t\tmessage.error('后台异常');\r\n\t\t\t\t\t\treject();\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t} else if (status === 404) {\r\n\t\t\t\t\t\tmessage.error('请求不存在');\r\n\t\t\t\t\t\treject();\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t} else if (status === 403) {\r\n\t\t\t\t\t\twindow.location.replace(\"/\");\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (response.config.responseType === 'blob') {\r\n\t\t\t\t\tresolve(data);\r\n\t\t\t\t} else if (response.config.responseType === 'json') {\r\n\t\t\t\t\tif (data.success) {\r\n\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata.msg && message.error(data.msg);\r\n\t\t\t\t\t\tif (data.code === 403) {\r\n\t\t\t\t\t\t\twindow.location.replace(\"/\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treject(data)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve(response);\r\n\t\t\t\t}\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tthat.deleteRequest(params.url);\r\n\t\t\t\treject({\r\n\t\t\t\t\tsuccess: false\r\n\t\t\t\t});\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tloadingBar.success();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n};\r\nexport default request;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}