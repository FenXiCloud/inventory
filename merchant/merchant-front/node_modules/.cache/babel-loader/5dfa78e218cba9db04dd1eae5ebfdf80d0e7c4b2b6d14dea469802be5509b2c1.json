{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport { createStore } from 'vuex';\nimport { toArrayTree } from 'xe-utils';\nimport { Init } from \"@js/api/App\";\nimport manba from \"manba\";\nexport default createStore({\n  state: {\n    siderCollapsed: false,\n    user: {},\n    menus: [],\n    orgs: [],\n    org: {},\n    granted: [],\n    tabs: [],\n    currentTab: 'DashboardMain'\n  },\n  mutations: {\n    updateMenus(state, data) {\n      state.menus = data;\n    },\n    updateOrgs(state, {\n      orgs\n    }) {\n      state.orgs = orgs;\n      let org = orgs.find(val => val.current === true);\n      org.checkoutSDate = manba(org.checkoutDate).add(1, manba.DAY).format(\"YYYY-MM-dd\");\n      state.org = org;\n    },\n    updateOrg(state, checkoutDate) {\n      if (checkoutDate) {\n        state.org.checkoutDate = checkoutDate;\n        state.org.checkoutSDate = manba(checkoutDate).add(1, manba.DAY).format(\"YYYY-MM-dd\");\n      }\n    },\n    updateAccount(state, {\n      account\n    }) {\n      state.user = account;\n      state.granted = account.granted || [];\n    },\n    updateSiderCollapse(state, isShow) {\n      setTimeout(() => {\n        state.pageResizeCount += 1;\n      }, 600);\n      state.siderCollapsed = isShow;\n    },\n    newTab(state, key) {\n      state.currentTab = key;\n    },\n    updateTab(state, tab) {\n      state.currentTab = tab;\n    },\n    pushTab(state, tab) {\n      if (!state.tabs.map(val => val.key).includes(tab.key)) {\n        state.tabs.push(tab);\n      }\n      state.currentTab = tab.key;\n    },\n    clearTabs(state) {\n      state.tabs = [];\n      state.currentTab = 'DashboardMain';\n    },\n    closeOtherTab(state, index) {\n      state.tabs = index < 0 ? [] : [state.tabs[index]];\n      state.currentTab = index < 0 ? 'DashboardMain' : state.tabs[0].key;\n    },\n    closeSelfTab(state, index) {\n      state.currentTab = index - 1 > -1 ? state.tabs[index - 1].key : 'DashboardMain';\n      state.tabs.splice(index, 1);\n    },\n    closeTabKey(state, key) {\n      let index = state.tabs.findIndex(val => val.key === key);\n      state.tabs.splice(index, 1);\n      state.currentTab = index - 1 > -1 ? state.tabs[index - 1].key : 'DashboardMain';\n    }\n  },\n  actions: {\n    init({\n      commit\n    }) {\n      return new Promise((resolve, reject) => {\n        Init().then(({\n          success,\n          data\n        }) => {\n          if (success) {\n            commit('updateAccount', data);\n            commit('updateOrgs', data);\n            commit('updateMenus', toArrayTree(data.menus, {\n              strict: true\n            }));\n            resolve(data.account);\n          } else {\n            reject();\n          }\n        }).catch(() => {\n          reject();\n        });\n      });\n    },\n    updateSiderCollapse({\n      commit\n    }, data) {\n      commit('updateSiderCollapse', data);\n    }\n  },\n  getters: {\n    account: state => {\n      return state.user;\n    },\n    siderCollapsed: state => {\n      return state.siderCollapsed;\n    }\n  }\n});","map":{"version":3,"names":["createStore","toArrayTree","Init","manba","state","siderCollapsed","user","menus","orgs","org","granted","tabs","currentTab","mutations","updateMenus","data","updateOrgs","find","val","current","checkoutSDate","checkoutDate","add","DAY","format","updateOrg","updateAccount","account","updateSiderCollapse","isShow","setTimeout","pageResizeCount","newTab","key","updateTab","tab","pushTab","map","includes","push","clearTabs","closeOtherTab","index","closeSelfTab","splice","closeTabKey","findIndex","actions","init","commit","Promise","resolve","reject","then","success","strict","catch","getters"],"sources":["D:/DevWorks/jxc/merchant/merchant-front/src/js/store.js"],"sourcesContent":["import {createStore} from 'vuex'\r\nimport {toArrayTree} from 'xe-utils'\r\nimport {Init} from \"@js/api/App\";\r\nimport manba from \"manba\";\r\n\r\nexport default createStore({\r\n  state: {\r\n    siderCollapsed: false,\r\n    user: {},\r\n    menus: [],\r\n    orgs: [],\r\n    org: {},\r\n    granted: [],\r\n    tabs: [],\r\n    currentTab:  'DashboardMain',\r\n  },\r\n  mutations: {\r\n    updateMenus(state, data) {\r\n      state.menus = data;\r\n    },\r\n    updateOrgs(state, {orgs}) {\r\n      state.orgs = orgs;\r\n      let org = orgs.find(val=>val.current===true)\r\n      org.checkoutSDate = manba(org.checkoutDate).add(1,manba.DAY).format(\"YYYY-MM-dd\")\r\n      state.org = org\r\n    },\r\n    updateOrg(state, checkoutDate) {\r\n      if(checkoutDate){\r\n        state.org.checkoutDate = checkoutDate\r\n        state.org.checkoutSDate = manba(checkoutDate).add(1,manba.DAY).format(\"YYYY-MM-dd\")\r\n      }\r\n    },\r\n    updateAccount(state, { account}) {\r\n      state.user = account;\r\n      state.granted = account.granted || [];\r\n    },\r\n    updateSiderCollapse(state, isShow) {\r\n      setTimeout(() => {\r\n        state.pageResizeCount += 1;\r\n      }, 600);\r\n      state.siderCollapsed = isShow;\r\n    },\r\n    newTab(state, key) {\r\n      state.currentTab = key;\r\n    },\r\n    updateTab(state, tab) {\r\n      state.currentTab = tab;\r\n    },\r\n    pushTab(state, tab) {\r\n      if (!state.tabs.map(val => val.key).includes(tab.key)) {\r\n        state.tabs.push(tab);\r\n      }\r\n      state.currentTab = tab.key;\r\n    },\r\n    clearTabs(state) {\r\n      state.tabs = [];\r\n      state.currentTab = 'DashboardMain';\r\n    },\r\n    closeOtherTab(state, index) {\r\n      state.tabs = index < 0 ? [] : [state.tabs[index]];\r\n      state.currentTab = index < 0 ? 'DashboardMain' : state.tabs[0].key;\r\n    },\r\n    closeSelfTab(state, index) {\r\n      state.currentTab = index - 1 > -1 ? state.tabs[index - 1].key : 'DashboardMain';\r\n      state.tabs.splice(index, 1);\r\n    },\r\n    closeTabKey(state, key) {\r\n      let index = state.tabs.findIndex(val => val.key === key);\r\n      state.tabs.splice(index, 1);\r\n      state.currentTab = index - 1 > -1 ? state.tabs[index - 1].key : 'DashboardMain';\r\n    },\r\n  },\r\n  actions: {\r\n    init({commit}) {\r\n      return new Promise((resolve, reject) => {\r\n        Init().then(({success, data}) => {\r\n          if (success) {\r\n            commit('updateAccount', data);\r\n            commit('updateOrgs', data);\r\n            commit('updateMenus', toArrayTree(data.menus, {strict: true}));\r\n            resolve(data.account);\r\n          } else {\r\n            reject();\r\n          }\r\n        }).catch(() => {\r\n          reject();\r\n        })\r\n      })\r\n    },\r\n    updateSiderCollapse({commit}, data) {\r\n      commit('updateSiderCollapse', data);\r\n    }\r\n  },\r\n  getters: {\r\n    account: state => {\r\n      return state.user;\r\n    },\r\n    siderCollapsed: state => {\r\n      return state.siderCollapsed;\r\n    }\r\n  }\r\n})\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}