import{u as f}from"./utils.js";import M from"./utils/config.js";import j from"./directives/tooltip.js";import{resolveComponent as u,openBlock as l,createElementBlock as r,normalizeClass as g,withDirectives as S,createElementVNode as m,vShow as N,toDisplayString as T,createVNode as _,createCommentVNode as p,mergeProps as k,createBlock as h,withCtx as B,Fragment as v,renderList as b}from"vue";import{_ as y}from"./_plugin-vue_export-helper.js";import{T as D}from"./tooltip.js";const E={name:"HMenuItemShow",directives:{tooltip:j},emits:["clickItem"],props:{data:Object,param:Object,status:Object,mode:String},data(){return{}},methods:{togglemenu(e){this.$emit("clickItem",{type:"togglemenuEvent",data:e})}}},K={class:"h-menu-show-icon"},P={class:"h-menu-show-desc"},V={key:0,class:"h-menu-show-count"},z={key:1,class:"h-menu-show-expand"},A=m("i",{class:"h-icon-angle-down"},null,-1),H=[A];function L(e,n,t,i,s,a){const o=u("Badge");return l(),r("div",{class:g(["h-menu-show",{"h-menu-show-disabled":t.data.status.disabled,"h-menu-li-selected":t.data.key&&t.status.selected==t.data.key}]),onClick:n[0]||(n[0]=c=>a.togglemenu(t.data))},[S(m("span",K,[m("i",{class:g(t.data.icon)},null,2)],512),[[N,t.data.icon]]),m("span",P,T(t.data.title),1),t.data.count?(l(),r("span",V,[_(o,{count:t.data.count,"max-count":99},null,8,["count"])])):p("",!0),t.mode!="horizontal"&&t.data.children&&t.data.children.length>0?(l(),r("span",z,H)):p("",!0)],2)}const F=y(E,[["render",L]]),q={name:"HMenuItem",components:{MenuItemShow:F,Tooltip:D},emits:["trigger"],props:{data:Object,param:Object,status:Object,mode:String},data(){return{}},computed:{href(){let e=this.data.value.href;if(e){if(f.isString(e))return e;if(this.$router)return this.$router.resolve(e).href}return null}},methods:{clickItem(e){this.$emit("trigger",e)},triggerClick(e){this.data.value.nativeLink!==!0&&!(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)&&e.preventDefault()}}},G=["target","href"],J={key:3,class:"h-menu-other-levels"};function Q(e,n,t,i,s,a){const o=u("MenuItemShow"),c=u("Tooltip"),x=u("hMenuItem");return l(),r("li",{class:g(["h-menu-li",{"h-menu-li-opened":t.status.opened.indexOf(t.data.key)!=-1}])},[t.data.value.href?(l(),r("a",{key:0,target:t.data.value.target,class:"h-menu-link",href:a.href,onClick:n[0]||(n[0]=(...d)=>a.triggerClick&&a.triggerClick(...d))},[_(o,k(e.$props,{onClickItem:a.clickItem}),null,16,["onClickItem"])],8,G)):t.mode==="collapse"&&!t.data.children.length?(l(),h(c,{key:1,content:t.data.title,placement:"right"},{default:B(()=>[_(o,k(e.$props,{onClickItem:a.clickItem}),null,16,["onClickItem"])]),_:1},8,["content"])):(l(),h(o,k({key:2},e.$props,{onClickItem:a.clickItem}),null,16,["onClickItem"])),t.data.children&&t.data.children.length>0?(l(),r("ul",J,[(l(!0),r(v,null,b(t.data.children,d=>(l(),h(x,{key:d.key,data:d,param:t.param,status:t.status,onTrigger:a.clickItem},null,8,["data","param","status","onTrigger"]))),128))])):p("",!0)],2)}const R=y(q,[["render",Q]]),I="h-menu",C=(e=[],n,t)=>{let i=[];for(let s of e){let a={key:s[n.keyName],title:s[n.titleName],icon:s.icon,count:s.count,value:s,status:{opened:!1,disabled:!!s.disabled},parent:t},o=s[n.childrenName]||[];a.children=C(o,n,a),i.push(a)}return i},O=(e=[],n)=>{let t={};for(let i of e){let s=i.key;s&&(t[s]=i);let a=i.children;a&&a.length&&f.extend(t,O(a))}return t},w=e=>{let n=[];return e.parent&&(n.push(e.parent.key),n.push(...w(e.parent))),n},U={mode:["vertical","horizontal","collapse","half-collapse"]},W={name:"HMenu",components:{hMenuItem:R},emits:["clickItem","select"],props:{option:Object,datas:{type:Array,default:()=>[]},className:{type:String,default:"h-menu-dark"},accordion:{type:Boolean,default:!1},mode:{type:String,validator(e){return U.mode.indexOf(e)>-1},default:"vertical"},activeAll:{type:Boolean,default:!1}},data(){let e={};return e=f.extend({},M.getOption("menu"),this.option),{param:e,status:{selected:null,opened:[]}}},computed:{classes(){return{[`${I}`]:!0,[this.className]:!0,[`${I}-mode-${this.mode}`]:this.mode}},menuobj(){return O(this.menuDatas)},menuDatas(){return C(this.datas,this.param)}},methods:{select(e){let n=this.menuobj[e];n?(this.status.selected=e,this.status.opened=w(n)):(this.status.selected=null,this.status.opened=[])},trigger(e){if(e.type=="togglemenuEvent"){let n=e.data;if(this.status.opened=f.toggleValue(this.status.opened,n.key),this.accordion&&this.status.opened.indexOf(n.key)>-1)for(let i in this.menuobj){let s=this.menuobj[i];s.parent===n.parent&&n.key!=i&&this.status.opened.indexOf(s.key)>-1&&this.status.opened.splice(this.status.opened.indexOf(s.key),1)}if(this.$emit("clickItem",n),n.children&&n.children.length>0&&(!this.activeAll||this.status.selected==n.key))return;this.status.selected=n.key,this.$emit("select",n.value)}}}};function X(e,n,t,i,s,a){const o=u("hMenuItem");return l(),r("ul",{class:g(a.classes)},[(l(!0),r(v,null,b(a.menuDatas,c=>(l(),h(o,{key:c.key,class:"h-menu-first-level",data:c,param:s.param,status:s.status,mode:t.mode,onTrigger:a.trigger},null,8,["data","param","status","mode","onTrigger"]))),128))],2)}const ae=y(W,[["render",X]]);export{ae as M};
