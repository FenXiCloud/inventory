import{u as n}from"./utils.js";import{openBlock as r,createElementBlock as d,normalizeClass as o,createElementVNode as u,withDirectives as h,vModelText as p,createCommentVNode as f}from"vue";import{_ as c}from"./_plugin-vue_export-helper.js";const m="h-numberinput",b={name:"HNumberInput",emits:["input","change","update:modelValue"],props:{modelValue:[Number,String],min:Number,max:Number,disabled:{type:Boolean,default:!1},step:{type:Number,default:1},placeholder:{type:String},useInt:{type:Boolean,default:!1},useOperate:{type:Boolean,default:!1},precision:{type:Number}},data(){return{focusing:!1,editValue:this.modelValue,valueBak:this.modelValue}},computed:{numberinputCls(){return{[m]:!0,[`${m}-disabled`]:!!this.disabled}}},watch:{modelValue(){this.valueBak!=this.modelValue&&(this.editValue=this.modelValue,this.valueBak=this.modelValue)}},mounted(){},methods:{plus(){if(this.disabled)return!1;let e=this.getValue(this.modelValue);this.setvalue(n.add(e||0,this.step),"handler")},minus(){if(this.disabled)return!1;let e=this.getValue(this.modelValue);this.setvalue(n.add(e||0,-this.step),"handler")},input(e){if(isNaN(Number(e.target.value)))return!1;let t=this.getValue(e.target.value);n.isNumber(this.modelValue)&&Math.abs(t-this.modelValue)<=1&&this.precision||this.setvalue(t,"input")},blur(e){this.focusing=!1;let t=this.getValue(e.target.value);this.setvalue(t,"blur")},getValue(e){if(e==="")return null;if(this.useInt){let t=parseInt(e);return isNaN(t)?null:t}else{let t=parseFloat(e);return isNaN(t)?null:t}},setvalue(e,t){if(this.disabled)return!1;this.max!==void 0&&e!==null&&(e=Math.min(this.max,e)),this.min!==void 0&&e!==null&&(e=Math.max(this.min,e)),this.precision&&n.isNumber(e)&&(e=Math.floor(n.mul(e||0,Math.pow(10,this.precision)))/Math.pow(10,this.precision),e=e.toFixed(this.precision)),this.valueBak=e,this.$emit("input",e),this.$emit("update:modelValue",e),t!="input"&&(this.editValue=e),t!="input"&&this.$emit("change",e);let l=document.createEvent("CustomEvent");l.initCustomEvent("setvalue",!0,!0,e),this.$el.dispatchEvent(l)}}},V=["placeholder","disabled"],N={key:0,class:"h-numberinput-operate"},g=u("i",{class:"h-icon-minus"},null,-1),v=[g],x=u("i",{class:"h-icon-plus"},null,-1),B=[x];function k(e,t,l,_,a,s){return r(),d("div",{class:o(s.numberinputCls)},[u("div",{class:o(["h-numberinput-show",{focusing:a.focusing}])},[h(u("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>a.editValue=i),type:"text",placeholder:l.placeholder,disabled:l.disabled===!1?null:!0,class:"h-numberinput-input h-input",onInput:t[1]||(t[1]=(...i)=>s.input&&s.input(...i)),onFocus:t[2]||(t[2]=i=>a.focusing=!0),onBlur:t[3]||(t[3]=(...i)=>s.blur&&s.blur(...i))},null,40,V),[[p,a.editValue]]),l.useOperate?(r(),d("div",N,[u("span",{onClick:t[4]||(t[4]=(...i)=>s.minus&&s.minus(...i))},v),u("span",{onClick:t[5]||(t[5]=(...i)=>s.plus&&s.plus(...i))},B)])):f("",!0)],2)],2)}const E=c(b,[["render",k]]);export{E as N};
