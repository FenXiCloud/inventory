import{u as l}from"./utils.js";import c from"./plugins/tooltip.js";import{openBlock as r,createElementBlock as d,normalizeClass as g,createElementVNode as a,normalizeStyle as u,withModifiers as p,createCommentVNode as m,toDisplayString as v}from"vue";import{_ as y}from"./_plugin-vue_export-helper.js";const f="h-slider",C={name:"HSlider",emits:["update:modelValue","change"],props:{readonly:{type:Boolean,default:!1},step:{type:Number,default:1},modelValue:{type:[Number,Object],default:0},show:Function,multiple:{type:Boolean,default:!1},showtip:{type:Boolean,default:!0},range:{default:()=>({start:0,end:100})},trackStyle:Object},data(){return{eventControl:{type:null,x:null,init:null},tooltip:{start:null,end:null}}},computed:{hasStart(){return this.multiple},computedTrackStyle(){let s=this.range.end-this.range.start;return Object.assign({left:`${parseInt((this.values.start-this.range.start)/s*100,10)}%`,right:`${parseInt((this.range.end-this.values.end)/s*100,10)}%`},this.trackStyle)},nodePosition(){let s=this.range.end-this.range.start;return{start:`${parseInt((this.values.start-this.range.start)/s*100,10)}%`,end:`${100-parseInt((this.range.end-this.values.end)/s*100,10)}%`}},values(){return this.multiple?l.extend({start:this.range.start,end:this.range.start},this.modelValue):{start:this.range.start,end:this.modelValue||this.range.start}},sliderCls(){return{[`${f}`]:!0}}},mounted(){this.$nextTick(()=>{if(!this.showtip)return;if(this.hasStart){let t=this.$el.querySelector(".h-slider-start-node");this.tooltip.start=new c(t,{content:this.$el.querySelector(".h-slider-start-node-modelValue"),html:!0,trigger:"manual hover",container:document.body,placement:this.placement})}let s=this.$el.querySelector(".h-slider-end-node");this.tooltip.end=new c(s,{content:this.$el.querySelector(".h-slider-end-node-modelValue"),html:!0,trigger:"manual hover",container:document.body,placement:this.placement})})},methods:{choosePosition(s){if(this.multiple)return;this.eventControl.type="end";let t=this.$el.querySelector(".h-slider-end-node").getBoundingClientRect();this.eventControl.x=t.left+t.width/2,this.eventControl.init=this.values.end,this.mousemove(s),document.body.addEventListener("mousemove",this.mousemove),document.body.addEventListener("mouseup",this.mouseup),document.body.addEventListener("click",this.click)},showContent(s){return this.show?this.show.call(null,s):s||this.range.start},mousedown(s,t){this.readonly||(l.addClass(t.target,"h-slider-node-dragging"),this.eventControl.type=s,this.eventControl.x=t.clientX,this.eventControl.init=this.values[s],document.body.addEventListener("mousemove",this.mousemove),document.body.addEventListener("mouseup",this.mouseup),document.body.addEventListener("click",this.click),this.tooltip[s]&&this.tooltip[s].show())},mouseup(s){if(s.stopPropagation(),this.readonly)return;document.body.removeEventListener("mousemove",this.mousemove),document.body.removeEventListener("mouseup",this.mouseup),setTimeout(()=>{document.body.removeEventListener("click",this.click)},200);let t=this.$el.querySelector(".h-slider-node-dragging");t&&l.removeClass(t,"h-slider-node-dragging");let n=this.eventControl.type;this.tooltip[n]&&this.tooltip[n].hide()},click(s){s.stopPropagation()},mousemove(s){if(this.readonly)return;let t=s.clientX-this.eventControl.x;if(t==0)return;let n=t/this.$el.querySelector(".h-slider-line").clientWidth;n=parseInt(n*(this.range.end-this.range.start),10),n=this.eventControl.init+n;let h=n%this.step;h!=0&&(n=n-h),n=Math.max(n,this.range.start),n=Math.min(n,this.range.end);let i=null,e=this.eventControl.type;this.hasStart?(i={},this.values.start>n&&e=="end"?(e="start",i=l.extend(this.values,{start:n,end:this.values.start})):this.values.end<n&&e=="start"?(e="end",i=l.extend(this.values,{start:this.values.end,end:n})):i=l.extend(this.values,{[e]:n})):(i=n,this.$emit("update:modelValue",i),this.$emit("change",i),e="end"),this.eventControl.type!=e&&(l.removeClass(this.$el.querySelector(".h-slider-node-dragging"),"h-slider-node-dragging"),l.addClass(this.$el.querySelector(`.h-slider-${e}-node`),"h-slider-node-dragging"),this.tooltip[this.eventControl.type]&&this.tooltip[this.eventControl.type].hide(),this.eventControl.type=e),this.$emit("update:modelValue",i),this.$emit("change",i);let o=document.createEvent("CustomEvent");o.initCustomEvent("setvalue",!0,!0,i),this.$el.dispatchEvent(o),this.tooltip[e]&&(this.tooltip[e].show(),this.tooltip[e].update())}}},w={class:"h-slider-container"},S={key:1,class:"h-slider-end-node-modelValue h-tooltip-inner-content"},k={key:2,class:"h-slider-start-node-modelValue h-tooltip-inner-content"};function b(s,t,n,h,i,e){return r(),d("div",{class:g(e.sliderCls)},[a("div",w,[a("div",{class:"h-slider-line",onMousedown:t[0]||(t[0]=(...o)=>e.choosePosition&&e.choosePosition(...o))},null,32),a("div",{class:"h-slider-track",style:u(e.computedTrackStyle),onMousedown:t[1]||(t[1]=(...o)=>e.choosePosition&&e.choosePosition(...o))},null,36),e.hasStart?(r(),d("div",{key:0,class:"h-slider-node h-slider-start-node",style:u({left:e.nodePosition.start}),onClick:t[2]||(t[2]=p(()=>{},["stop"])),onMousedown:t[3]||(t[3]=o=>e.mousedown("start",o))},null,36)):m("",!0),a("div",{class:"h-slider-node h-slider-end-node",style:u({left:e.nodePosition.end}),onClick:t[4]||(t[4]=p(()=>{},["stop"])),onMousedown:t[5]||(t[5]=o=>e.mousedown("end",o))},null,36),n.showtip?(r(),d("span",S,v(e.showContent(e.values.end)),1)):m("",!0),n.showtip&&e.hasStart?(r(),d("span",k,v(e.showContent(e.values.start)),1)):m("",!0)])],2)}const q=y(C,[["render",b]]);export{q as S};
